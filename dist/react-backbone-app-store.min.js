var AppStore=function(){this.modelHash={},this.COLLECTIONS={},this.ENDPOINTS={},this.rootNode=null,this.rootProps={}};AppStore.prototype.registerModel=function(t,e,o){this.modelHash[t]=this.modelHash[t]||{},this.COLLECTIONS[t]=this.COLLECTIONS[t]||e,this.ENDPOINTS[t]=this.ENDPOINTS[t]||o},AppStore.prototype.resetData=function(t,e,o){var r={};for(var s in this.modelHash)t[s]&&(r[s]=t[s]);this.resetModelHash(r),this.rootProps=_.extend(t,{appStore:this}),this.fetchCache={};var h=React.createElement(e,this.rootProps,o);this.rootNode=React.render(h,o)},AppStore.prototype.resetModelHash=function(t){for(var e in t){var o=t[e],r=this.COLLECTIONS[e];this.modelHash[e]=new r(o)}},AppStore.prototype.renderRoot=function(){for(var t in this.modelHash)this.rootProps[t]=this.modelHash[t].toJSON();this.rootNode.setProps(this.rootProps)},AppStore.prototype.fetch=function(t,e,o){if(!_.isArray(t)||!t.length)return o&&o();var r=this,s=[];_.each(t,function(t){r.fetchCache[t]||(s.push(t),r.fetchCache[t]=!0)});var h=0,i=s.length,p="/api/"+this.ENDPOINTS[e]+"/";_.each(s,function(t){$.get(p+t,function(s){r.modelHash[e].add(s),delete r.fetchCache[t],++h===i&&(r.renderRoot(),o&&o())})})},AppStore.prototype.getModel=function(t,e){var o=this.modelHash[e].get(t);return o&&o.toJSON()},AppStore.prototype.set=function(t,e,o,r){var s=this.modelHash[o].get(e),h=this;s.save(t,{wait:!0,success:function(t){h.refresh(e,o,r)}})},AppStore.prototype.refresh=function(t,e,o){var r=this.modelHash[e].get(t),s=this;r.fetch({wait:!0,success:function(t,e){s.renderRoot(),o&&o()}})},window.AppStore=AppStore;